{"version":3,"sources":["app.js"],"names":["g","svg","detroitZipCodes","fetchMapData","d3","json","error","map","console","log","Error","drawMap","width","height","projection","geoAlbersUsa","scale","translate","forEach","zcDataObj","zipcodeData","el","properties","ZCTA5CE10","value","erVisits","VALUE","array","Object","values","min","max","updateMinAndMax","scaleLinear","domain","range","path","geoPath","select","attrs","zoom","on","zoomed","call","append","attr","selectAll","data","enter","d","fill","stroke","clicked","event","transform","document","querySelector","innerText"],"mappings":"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","file":"app.js","sourcesContent":["/*\n*  RUN\n*/\n\nlet g, svg, detroitZipCodes;\nfetchMapData()\n\n\n/*\n*  HELPERS\n*/\n\nfunction fetchMapData(){\n\n  //FETCH EITHER ALL ZIPCODES THEN CONVERT OR JUST DETROIT ZIP CODES\n  // d3.json(\"./geojson/zipcodes.json\", (error, map) => {\n  d3.json(\"./geojson/detroitZipCodes.json\", (error, map) => {\n    if(error) {\n      console.log(error)\n      throw new Error(\"Chrome has strict security permissions and won't allow you to fetch from a local file system. Use `http-server` to serve these files over HTTP to make the map visualization to work.\")\n    } else {\n      drawMap(map)\n    }\n  })\n}\n\nfunction drawMap(map){\n  let width = 900,\n      height = 600;\n  \n  // SCALE AND TRANSLATE BASED ON POSITION OF DETROIT\n  let projection = d3.geoAlbersUsa()\n                      .scale(30000)\n                      .translate([width * -5.5, height * 4]);\n\n  // FILTER ALL ZIPCODES TO JUST DETROIT ZIPCODES\n  // let zipcodes = topojson.feature(map, map.objects.zcs)\n  // detroitZipCodes = zipcodes.features.filter(el => {\n  //   let zc = el.properties.ZCTA5CE10\n  //   return zc > 48200 && zc < 48289\n  // })\n\n\n  //MAP DATA TO PROPERTIES IN ZIPCODE DATA\n  map.forEach(el => {\n    let zcDataObj = zipcodeData[el.properties.ZCTA5CE10]\n    let value = 'N/A'\n    if(zcDataObj) value = zcDataObj.erVisits\n    el.properties.VALUE = value\n  })\n\n  //init SCALE\n  let array = Object.values(zipcodeData)\n  let min = d3.min(array, el => el.erVisits)\n  let max = d3.max(array, el => el.erVisits)\n  updateMinAndMax(min, max)\n\n  let scale = d3.scaleLinear()\n                .domain([min, max])\n                .range(['blue', 'red'])\n\n  let path = d3.geoPath().projection(projection)\n  svg = d3.select('svg').attrs({\n    width: width,\n    height: height\n  })\n\n  let zoom = d3.zoom()\n      .on('zoom', zoomed)\n  svg.call(zoom)\n\n  g = svg.append('g').attr('class','global')\n  g.selectAll('.zipcodes')\n    // .data(detroitZipCodes)\n    .data(map)\n    .enter()\n    .append('path')\n    .attrs({\n      d: path,\n      fill: d => scale(d.properties.VALUE),\n      stroke: 'white',\n      'stroke-width': 0.1\n    }).on('click', clicked)\n}\n\nfunction zoomed(){\n  g.attr('transform', d3.event.transform)\n}\n\nfunction clicked(d){\n  console.log(d)\n  document.querySelector('.zipcode').innerText = d.properties.ZCTA5CE10\n  document.querySelector('.result').innerText = d.properties.VALUE\n  \n}\n\nfunction updateMinAndMax(min, max){\n  document.querySelector('.min').innerText = min\n  document.querySelector('.max').innerText = max\n}"]}